name: Hipchat
tags: [ chat, notifications ]
logo: hipchat.svg
license: apache2
author: jmccann
image: jmccann/drone-hipchat

description: |
  Use this plugin for sending build status notifications via HipChat.

example: |
  pipeline:
    hipchat:
      image: jmccann/drone-hipchat:0.5
      room: myRoomName

params:
  url: HipChat server URL, defaults to `https://api.hipchat.com`
  auth_token: HipChat V2 API token; use a room or user token with the `Send Notification` scope
  room: ID or URL encoded name of the room
  from: A label to be shown, defaults to `drone`
  notify: |
    Whether this message should trigger a user notification (change the
    tab color, play a sound, notify mobile phones, etc). Each recipient's
    notification preferences are taken into account, defaults to `false`

secrets:
  auth_token:
    env: HIPCHAT_AUTH_TOKEN

examples:
  - desc: Override the default acl and region:
    code: >
      pipeline:
        hipchat:
          image: jmccann/drone-hipchat:0.5
          room: myRoomName
      +   template: >
      +     <strong>{{ uppercasefirst build.status }}</strong> <a href=\"{{ system.link_url }}/{{ repo.owner }}/{{ repo.name }}/{{ build.number }}\">{{ repo.owner }}/{{ repo.name }}#{{ truncate build.commit 8 }}</a> ({{ build.branch }}) by {{ build.author }} in {{ duration build.started_at build.finished_at }} </br> - {{ build.message }}
